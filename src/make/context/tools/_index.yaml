version: "1.0"
namespace: keeper.make.context.tools

entries:
  # keeper.make.context.tools:search_context
  - name: search_context
    kind: function.lua
    meta:
      type: tool
      title: Context Search
      description: Enables agents to search for additional Wippy system context during operation
      input_schema: "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"query\": { \n      \"type\": \"string\", \n      \"description\": \"Specific Wippy system information needed.\" \n    },\n    \"title\": { \n      \"type\": \"string\", \n      \"description\": \"Short title for this search (3-4 words).\", \n      \"maxLength\": 40 \n    },\n    \"agent_id\": {\n      \"type\": \"string\",\n      \"description\": \"Optional specific context search agent to use (e.g., 'keeper.make.context.agents:api_interface_search', must have a valid class)\"\n    },\n    \"context_uuids\": {\n      \"type\": \"array\",\n      \"items\": {\n        \"type\": \"string\"\n      },\n      \"description\": \"Optional array of existing context UUIDs to include as references in the search\"\n    }\n  },\n  \"required\": [\"query\", \"title\"]\n}\n"
      llm_alias: search_context
      llm_description: Searches for additional Wippy system context to help with planning and task execution. Provide specific query about what context is needed. Optionally specify which search agent to use and existing context UUIDs to reference.
    source: file://search_context.lua
    modules:
      - json
      - ctx
      - uuid
    imports:
      consts: dataflow:consts
      starter: dataflow.runner:starter
    method: execute
    
  # keeper.make.context.tools:summarize_context
  - name: summarize_context
    kind: function.lua
    meta:
      type: tool
      title: Summarize Context
      description: Generate intelligent summaries of context items using LLM, with optional query-guided focus
      input_schema: |
        {
          "type": "object",
          "properties": {
            "uuids": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Array of context UUIDs to retrieve and summarize",
              "minItems": 1
            },
            "query": {
              "type": "string",
              "description": "Optional specific question or focus area for the summary"
            },
            "max_tokens": {
              "type": "number",
              "description": "Maximum tokens for the summary (default: 500)",
              "minimum": 50,
              "maximum": 2000
            }
          },
          "required": ["uuids"]
        }
      llm_alias: summarize_context
      llm_description: Generate an intelligent summary of specific context items. Optionally provide a query to focus the summary on particular aspects or questions.
    source: file://summarize_context.lua
    modules:
      - json
      - ctx
    imports:
      prompt: wippy.llm:prompt
      context_reader: dataflow.node:context
      llm: wippy.llm:llm
    method: execute
    
  # keeper.make.context.tools:view_context
  - name: view_context
    kind: function.lua
    meta:
      type: tool
      title: View Context
      description: Retrieve and view specific context items by their UUIDs
      input_schema: |
        {
          "type": "object",
          "properties": {
            "uuids": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Array of context UUIDs to retrieve and view",
              "minItems": 1
            }
          },
          "required": ["uuids"]
        }
      llm_alias: view_context
      llm_description: View specific context items by providing their UUIDs. Returns formatted context content as a string.
    source: file://view_context.lua
    modules:
      - json
      - ctx
    imports:
      context_reader: dataflow.node:context
    method: execute
    